extends ../../layouts/default.pug
include ../../mixins/panigation.pug

block main
  .container-fluid.mt-4
    .d-flex.justify-content-between.align-items-center.mb-3
      h2.mb-0 Danh sách sản phẩm
      form(method="GET", action="", class="d-flex")
        input.form-control.me-2(type="text", name="search", value=search || '', placeholder="Tìm sản phẩm...")
        button.btn.btn-outline-secondary(type="submit")
          i.fas.fa-search
      form(method="GET", action=`${prefixAdmin}/products`, class="d-flex align-items-center")
        select.form-select(name="featured", onchange="this.form.submit()")
          option(value="") -- Tất cả --
          option(value=1, selected=featuredFilter === "1") Nổi bật
          option(value=0, selected=featuredFilter === "0") Không nổi bật
      a.btn.btn-primary(href=`${prefixAdmin}/products/create`)
        i.fas.fa-plus.me-1
        | Thêm sản phẩm

    if products.length > 0
      .table-responsive
        table.table.table-bordered.table-hover.align-middle
          thead.table-light
            tr
              th STT
              th Hình ảnh
              th Tên sản phẩm
              th Giá
              th Giảm giá
              th Số lượng
              th Nổi bật
              th Ngày tạo
              th.text-center Hành động
          tbody
            each product, index in products
              tr
                td #{index + 1}
                td
                  img(src=product.image, alt="Ảnh sản phẩm", style="width: 60px; height: 60px; object-fit: cover; border-radius: 6px;")
                td #{product.title}
                td #{product.price.toLocaleString()} đ
                td #{product.discount}% 
                td #{product.stock}
                td #{product.featured ? "Có" : "Không"}
                td #{new Date(product.createdAt).toLocaleDateString('vi-VN')}
                td.text-center
                  a.btn.btn-sm.btn-warning.me-1(href=`${prefixAdmin}/products/detail/${product.id}`)
                    i.fas.fa-edit
                  form(method="POST", action=`${prefixAdmin}/products/delete/${product.id}?_method=DELETE`, class="d-inline")
                    button.btn.btn-sm.btn-danger(type="submit" onclick="return confirm('Bạn có chắc muốn xóa sản phẩm này?');")
                      i.fas.fa-trash

    else
      .alert.alert-info Không có sản phẩm nào.
    +panigation(objectPanigation)
